# Total Radiation Belt Electron Content

MATLAB code used to compute the Total Radiation Belt Electron Content (TRBEC) using particle flux measurements from the Van Allen Probes Magnetic Electron Ion Spectrometer (MagEIS) instrument, either as a function of the non-adiabatic invariants of kinetic energy (E), pitch angle (PA), and L-shell (L*) or the adiabatic invariants of magnetic moment (mu), second adiabatic invariant K, and L*.

## Brief File Description
The TRBEC_E_PA.m\TRBEC_mu_K.m files contain the necessary code to compute the TRBEC following the procedure outlined in _Estimating Electron Precipitation using the Total Radiation Belt Electron Content_ (J. Pitzel 2022, https://dx.doi.org/10.11575/PRISM/40159). The procedure has also been submitted (as of May, 2024) to _Journal of Geophysical Research: Space Physics_ as a "Technical Reports: Methods" paper. 

For non-adiabatic coordinates of E and PA the input data is the L3 MagEIS flux measurements avalible from the Coordinated Data Analysis Web (CDAWeb) (https://cdaweb.gsfc.nasa.gov/) or the Los Alamos National Laboratory (LANL) (https://rbsp-ect.newmexicoconsortium.org/data_pub/). For the adiabatic coordinates of mu and K the required input data is the adiabatic PSD avalible from the Radiation Belt Storm Probes Gateway (RBSPGWAY) (https://rbspgway.jhuapl.edu/) as well as the non-adiabatic data for magnetic field information. The provided MATLAB code also requires the MATLAB curve fitting toolbox and NASA's CDF reader for MATLAB (https://cdf.gsfc.nasa.gov/html/matlab_cdf_patch.html). Each TRBEC data point is computed from each Van Allen Probes half orbit, the computation time for each point is on the order of seconds so a secondary function is to output an intermediate data product called the differential content (DC) is created to more efficiently compute different sets of integration bounds. The DC is computed as the TRBEC integrand after integration over PA or K for all trapped particles and is most useful for computing the TRBEC of multiple particle populations quickly.

The TRBEC_E_PA_from_DC.m/TRBEC_mu_K_from_DC.m files use the DC quickly compute the TRBEC given a set of integration bounds in either E,L* or mu,L*. The DC dataset has been precomputed in E/L* for the entire RBSP mission, but only for January-March 2013 for the adiabatic bounds.
